import{r as i,b as _,e as D,f as l,m as E,d as m,o as T,g as a,n as c,p as d,C as $,D as q,i as z,V as p,E as V,A as g,a6 as B,h as y,q as U,z as A,a5 as F}from"./index-DoDgtyCs.js";import{V as M}from"./VDataTable-tGQr_UdE.js";import"./VTable-BI8bL8qs.js";const j={__name:"Languages",setup(N){const v=i([]),s=i(!1),u=i(!1),C=[{title:"ID",key:"id"},{title:"Название",key:"title"},{title:"Действия",key:"actions",sortable:!1}],o=i({title:""}),n=i({id:null,title:""}),f=async()=>{s.value=!0;try{const t=await m.get("/api/languages");v.value=t.data}catch(t){console.error("Error fetching languages:",t)}finally{s.value=!1}},w=async()=>{var t;if(o.value.title){s.value=!0;try{await m.post("/api/languages/",o.value),o.value.title="",await f()}catch(e){console.error("Error creating language:",e),((t=e.response)==null?void 0:t.status)===409?alert("Язык с таким названием уже существует"):alert("Ошибка при создании языка")}finally{s.value=!1}}},b=t=>{n.value={...t},u.value=!0},k=async()=>{var t;if(n.value.title){s.value=!0;try{await m.put(`/api/languages/${n.value.id}`,{title:n.value.title}),u.value=!1,await f()}catch(e){console.error("Error updating language:",e),((t=e.response)==null?void 0:t.status)===409?alert("Язык с таким названием уже существует"):alert("Ошибка при обновлении языка")}finally{s.value=!1}}},x=async t=>{if(confirm("Вы уверены, что хотите удалить этот язык?")){s.value=!0;try{await m.delete(`/api/languages/${t.id}`),await f()}catch(e){console.error("Error deleting language:",e)}finally{s.value=!1}}};return _(f),(t,e)=>(T(),D(E,null,{default:l(()=>[a(y,{class:"pa-6"},{default:l(()=>[a(c,{class:"text-h5 mb-4"},{default:l(()=>e[4]||(e[4]=[d(" Управление языками программирования ")])),_:1}),a($,{onSubmit:q(w,["prevent"]),class:"mb-6"},{default:l(()=>[a(z,null,{default:l(()=>[a(p,{cols:"12",md:"8"},{default:l(()=>[a(V,{modelValue:o.value.title,"onUpdate:modelValue":e[0]||(e[0]=r=>o.value.title=r),label:"Название языка",required:"",rules:[r=>!!r||"Название обязательно"]},null,8,["modelValue","rules"])]),_:1}),a(p,{cols:"12",md:"4",class:"d-flex align-center"},{default:l(()=>[a(g,{color:"primary",type:"submit",loading:s.value,disabled:!o.value.title},{default:l(()=>e[5]||(e[5]=[d(" Добавить язык ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),a(M,{headers:C,items:v.value,loading:s.value,class:"elevation-1"},{"item.actions":l(({item:r})=>[a(g,{icon:"mdi-pencil",size:"small",color:"primary",class:"me-2",onClick:L=>b(r)},null,8,["onClick"]),a(g,{icon:"mdi-delete",size:"small",color:"error",onClick:L=>x(r)},null,8,["onClick"])]),_:1},8,["items","loading"]),a(B,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=r=>u.value=r),"max-width":"500px"},{default:l(()=>[a(y,null,{default:l(()=>[a(c,null,{default:l(()=>e[6]||(e[6]=[d("Редактировать язык")])),_:1}),a(U,null,{default:l(()=>[a(V,{modelValue:n.value.title,"onUpdate:modelValue":e[1]||(e[1]=r=>n.value.title=r),label:"Название языка",required:""},null,8,["modelValue"])]),_:1}),a(A,null,{default:l(()=>[a(F),a(g,{color:"error",onClick:e[2]||(e[2]=r=>u.value=!1)},{default:l(()=>e[7]||(e[7]=[d("Отмена")])),_:1}),a(g,{color:"primary",onClick:k},{default:l(()=>e[8]||(e[8]=[d("Сохранить")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}};export{j as default};
