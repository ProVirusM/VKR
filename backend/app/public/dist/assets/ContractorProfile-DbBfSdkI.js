import{_ as F,r as w,R as I,b as P,e as m,f as e,m as H,d as M,o as i,g as l,V as _,h as b,i as y,$ as U,a,t as n,v as D,p as u,n as N,a7 as S,Y as g,q as z,c as f,k as h,F as k,j,A as q,a5 as E,a1 as Y,u as Z,D as G,a0 as J,l as K,Z as Q}from"./index-BS_DGpDW.js";import{V as W}from"./VTable-CqhgBNWO.js";const X={class:"text-h3 white--text"},tt={class:"text-grey-darken-1"},et={class:"d-flex align-center mb-4"},st=["href"],lt={key:1,class:"text-grey"},at={class:"d-flex align-center mb-4"},ot=["onClick"],rt={key:1,class:"text-grey"},nt={class:"d-flex align-center justify-space-between mb-4"},it={class:"d-flex align-center"},ut={class:"font-weight-bold mb-1"},dt={class:"text-caption mt-1"},ct={key:1,class:"text-grey"},mt={__name:"ContractorProfile",setup(ft){const B=Y(),V=Z(),d=w(null),v=w({show:!1,text:"",color:"success"}),x=w("highToLow"),A=[{title:"Сначала с высокой оценкой",value:"highToLow"},{title:"Сначала с низкой оценкой",value:"lowToHigh"},{title:"По дате (сначала новые)",value:"newToOld"},{title:"По дате (сначала старые)",value:"oldToNew"}],C=I(()=>{var s;if(!((s=d.value)!=null&&s.feedbacks))return[];const c=[...d.value.feedbacks];switch(x.value){case"highToLow":return c.sort((t,r)=>r.estimation-t.estimation);case"lowToHigh":return c.sort((t,r)=>t.estimation-r.estimation);case"newToOld":return c.sort((t,r)=>new Date(r.timestamp)-new Date(t.timestamp));case"oldToNew":return c.sort((t,r)=>new Date(t.timestamp)-new Date(r.timestamp));default:return c}}),L=async()=>{try{const c=await M.get(`/api/contractors/${B.params.id}/full-profile`);d.value=c.data}catch{v.value={show:!0,text:"Ошибка загрузки профиля",color:"error"}}},O=c=>{V.push(`/projects/${c}`)},R=c=>{V.push(`/contractor/orders/${c}`)};return P(L),(c,s)=>(i(),m(H,{class:"py-10"},{default:e(()=>[l(y,{justify:"center"},{default:e(()=>[l(_,{cols:"12",md:"10",lg:"8"},{default:e(()=>[l(b,{class:"profile-card mb-8",elevation:"8"},{default:e(()=>[l(y,{"no-gutters":"",align:"center"},{default:e(()=>[l(_,{cols:"auto",class:"d-flex flex-column align-center px-8 py-8 profile-avatar-col"},{default:e(()=>[l(U,{size:"110",color:"primary",class:"mb-4 elevation-6"},{default:e(()=>{var t,r,o;return[a("span",X,n(((o=(r=(t=d.value)==null?void 0:t.user)==null?void 0:r.name)==null?void 0:o.charAt(0))||"?"),1)]}),_:1}),l(D,{color:"primary",class:"mt-2","prepend-icon":"mdi-account-badge"},{default:e(()=>s[4]||(s[4]=[u("Исполнитель")])),_:1})]),_:1}),l(_,null,{default:e(()=>[l(N,{class:"text-h4 font-weight-bold mb-2"},{default:e(()=>{var t,r,o,p,T,$;return[u(n((r=(t=d.value)==null?void 0:t.user)==null?void 0:r.surname)+" "+n((p=(o=d.value)==null?void 0:o.user)==null?void 0:p.name)+" "+n(($=(T=d.value)==null?void 0:T.user)==null?void 0:$.patronymic),1)]}),_:1}),l(S,{class:"mb-2"},{default:e(()=>{var t,r;return[l(g,{size:"20",color:"grey-darken-1",class:"mr-1"},{default:e(()=>s[5]||(s[5]=[u("mdi-email")])),_:1}),a("span",tt,n((r=(t=d.value)==null?void 0:t.user)==null?void 0:r.email),1)]}),_:1}),l(z,{class:"text-body-1 mt-2"},{default:e(()=>{var t;return[u(n(((t=d.value)==null?void 0:t.description)||"Нет описания"),1)]}),_:1})]),_:1})]),_:1})]),_:1}),l(b,{class:"mb-8 pa-6",elevation:"4"},{default:e(()=>{var t,r;return[a("div",et,[l(g,{color:"indigo",class:"mr-2"},{default:e(()=>s[6]||(s[6]=[u("mdi-github")])),_:1}),s[7]||(s[7]=a("h3",{class:"text-h5 font-weight-bold mb-0"},"Проекты",-1))]),(r=(t=d.value)==null?void 0:t.projects)!=null&&r.length?(i(),m(y,{key:0,class:"project-list"},{default:e(()=>[(i(!0),f(k,null,h(d.value.projects,o=>(i(),m(_,{key:o.id,cols:"12",md:"6"},{default:e(()=>[l(b,{class:"mb-4 project-card",elevation:"2",onClick:p=>O(o.id),style:{cursor:"pointer"}},{default:e(()=>[l(N,{class:"font-weight-bold text-primary"},{default:e(()=>[u(n(o.name),1)]),_:2},1024),l(S,null,{default:e(()=>[l(g,{size:"18",color:"grey-darken-1",class:"mr-1"},{default:e(()=>s[8]||(s[8]=[u("mdi-link-variant")])),_:1}),a("a",{href:o.repository,target:"_blank",onClick:s[0]||(s[0]=G(()=>{},["stop"]))},n(o.repository),9,st)]),_:2},1024),l(z,null,{default:e(()=>[u(n(o.text),1)]),_:2},1024),o.photos&&o.photos.length?(i(),m(y,{key:0,class:"mt-2"},{default:e(()=>[(i(!0),f(k,null,h(o.photos,p=>(i(),m(_,{key:p.id,cols:"6"},{default:e(()=>[l(J,{src:p.link,"aspect-ratio":"1",class:"rounded-lg",cover:""},null,8,["src"])]),_:2},1024))),128))]),_:2},1024)):K("",!0)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})):(i(),f("div",lt,"Нет проектов"))]}),_:1}),l(b,{class:"mb-8 pa-6",elevation:"4"},{default:e(()=>{var t,r;return[a("div",at,[l(g,{color:"teal-darken-2",class:"mr-2"},{default:e(()=>s[9]||(s[9]=[u("mdi-briefcase-outline")])),_:1}),s[10]||(s[10]=a("h3",{class:"text-h5 font-weight-bold mb-0"},"Заказы",-1))]),(r=(t=d.value)==null?void 0:t.orders)!=null&&r.length?(i(),m(W,{key:0,class:"orders-table"},{default:e(()=>[s[11]||(s[11]=a("thead",null,[a("tr",null,[a("th",null,"Название"),a("th",null,"Статус"),a("th",null,"Цена"),a("th",null,"Срок"),a("th",null,"Статус участия")])],-1)),a("tbody",null,[(i(!0),f(k,null,h(d.value.orders,o=>(i(),f("tr",{key:o.id,onClick:p=>R(o.id),style:{cursor:"pointer"}},[a("td",null,n(o.title),1),a("td",null,[l(D,{color:o.status==="Завершен"?"success":o.status==="В работе"?"primary":"grey",size:"small"},{default:e(()=>[u(n(o.status),1)]),_:2},1032,["color"])]),a("td",null,n(o.price),1),a("td",null,n(o.time),1),a("td",null,n(o.order_contractor_status),1)],8,ot))),128))])]),_:1})):(i(),f("div",rt,"Нет заказов"))]}),_:1}),l(b,{class:"pa-6",elevation:"4"},{default:e(()=>[a("div",nt,[a("div",it,[l(g,{color:"amber-darken-2",class:"mr-2"},{default:e(()=>s[12]||(s[12]=[u("mdi-star-outline")])),_:1}),s[13]||(s[13]=a("h3",{class:"text-h5 font-weight-bold mb-0"},"Отзывы",-1))]),l(j,{modelValue:x.value,"onUpdate:modelValue":s[1]||(s[1]=t=>x.value=t),items:A,label:"Сортировка",density:"compact",variant:"outlined",class:"feedback-sort","hide-details":""},null,8,["modelValue"])]),C.value.length?(i(),m(y,{key:0},{default:e(()=>[(i(!0),f(k,null,h(C.value,t=>(i(),m(_,{key:t.id,cols:"12"},{default:e(()=>[l(Q,{type:t.estimation>=4?"success":t.estimation>=3?"warning":"error",class:"mb-2"},{default:e(()=>[a("div",ut,[l(g,{left:"",size:"18",color:"amber"},{default:e(()=>s[14]||(s[14]=[u("mdi-star")])),_:1}),u(" Оценка: "+n(t.estimation),1)]),a("div",null,n(t.text),1),a("div",dt,n(t.timestamp),1)]),_:2},1032,["type"])]),_:2},1024))),128))]),_:1})):(i(),f("div",ct,"Нет отзывов"))]),_:1})]),_:1})]),_:1}),l(E,{modelValue:v.value.show,"onUpdate:modelValue":s[3]||(s[3]=t=>v.value.show=t),color:v.value.color,timeout:3e3},{actions:e(()=>[l(q,{variant:"text",onClick:s[2]||(s[2]=t=>v.value.show=!1)},{default:e(()=>s[15]||(s[15]=[u("Закрыть")])),_:1})]),default:e(()=>[u(n(v.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}},_t=F(mt,[["__scopeId","data-v-97b11ecc"]]);export{_t as default};
