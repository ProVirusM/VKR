import{r as i,b as _,e as D,f as l,m as E,d as m,o as T,g as a,n as c,p as d,C as $,D as q,i as z,V as p,E as V,A as g,a4 as B,h as y,q as U,z as A,a3 as F}from"./index-BS_DGpDW.js";import{V as M}from"./VDataTable-4UGNYHhj.js";import"./VTable-CqhgBNWO.js";const j={__name:"Languages",setup(N){const v=i([]),o=i(!1),u=i(!1),C=[{title:"ID",key:"id"},{title:"Название",key:"title"},{title:"Действия",key:"actions",sortable:!1}],n=i({title:""}),s=i({id:null,title:""}),f=async()=>{o.value=!0;try{const r=await m.get("/api/languages");v.value=r.data}catch(r){console.error("Error fetching languages:",r)}finally{o.value=!1}},w=async()=>{if(n.value.title){o.value=!0;try{await m.post("/api/languages/",n.value),n.value.title="",await f()}catch(r){console.error("Error creating language:",r)}finally{o.value=!1}}},b=r=>{s.value={...r},u.value=!0},k=async()=>{var r,e;if(s.value.title){o.value=!0;try{await m.put(`/api/languages/${s.value.id}`,{title:s.value.title}),u.value=!1,await f(),alert("Язык успешно обновлен")}catch(t){console.error("Error updating language:",t),alert(((e=(r=t.response)==null?void 0:r.data)==null?void 0:e.error)||"Ошибка при обновлении языка")}finally{o.value=!1}}},x=async r=>{if(confirm("Вы уверены, что хотите удалить этот язык?")){o.value=!0;try{await m.delete(`/api/languages/${r.id}`),await f()}catch(e){console.error("Error deleting language:",e)}finally{o.value=!1}}};return _(f),(r,e)=>(T(),D(E,null,{default:l(()=>[a(y,{class:"pa-6"},{default:l(()=>[a(c,{class:"text-h5 mb-4"},{default:l(()=>e[4]||(e[4]=[d(" Управление языками программирования ")])),_:1}),a($,{onSubmit:q(w,["prevent"]),class:"mb-6"},{default:l(()=>[a(z,null,{default:l(()=>[a(p,{cols:"12",md:"8"},{default:l(()=>[a(V,{modelValue:n.value.title,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value.title=t),label:"Название языка",required:"",rules:[t=>!!t||"Название обязательно"]},null,8,["modelValue","rules"])]),_:1}),a(p,{cols:"12",md:"4",class:"d-flex align-center"},{default:l(()=>[a(g,{color:"primary",type:"submit",loading:o.value,disabled:!n.value.title},{default:l(()=>e[5]||(e[5]=[d(" Добавить язык ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),a(M,{headers:C,items:v.value,loading:o.value,class:"elevation-1"},{"item.actions":l(({item:t})=>[a(g,{icon:"mdi-pencil",size:"small",color:"primary",class:"me-2",onClick:L=>b(t)},null,8,["onClick"]),a(g,{icon:"mdi-delete",size:"small",color:"error",onClick:L=>x(t)},null,8,["onClick"])]),_:1},8,["items","loading"]),a(B,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=t=>u.value=t),"max-width":"500px"},{default:l(()=>[a(y,null,{default:l(()=>[a(c,null,{default:l(()=>e[6]||(e[6]=[d("Редактировать язык")])),_:1}),a(U,null,{default:l(()=>[a(V,{modelValue:s.value.title,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.title=t),label:"Название языка",required:""},null,8,["modelValue"])]),_:1}),a(A,null,{default:l(()=>[a(F),a(g,{color:"error",onClick:e[2]||(e[2]=t=>u.value=!1)},{default:l(()=>e[7]||(e[7]=[d("Отмена")])),_:1}),a(g,{color:"primary",onClick:k},{default:l(()=>e[8]||(e[8]=[d("Сохранить")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}};export{j as default};
