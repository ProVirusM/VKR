import{Q as A,R as I,S as L,T as U,U as M,W as j,X as q,Y as E,Z as G,g as l,$ as J,_ as K,r as P,a0 as Q,b as W,e as b,f as t,m as X,d as Y,o as u,V as g,h as k,i as w,H as Z,a as s,t as n,v as $,p as d,n as F,a1 as z,K as _,q as H,c as p,k as C,F as B,j as ee,A as te,O as ae,J as le,u as se,D as oe,I as re,l as ne,G as ie}from"./index-B4YrDoW6.js";const ue=A({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...I(),...L(),...U(),...M()},"VTable"),de=j()({name:"VTable",props:ue(),setup(f,D){let{slots:i,emit:c}=D;const{themeClasses:v}=q(f),{densityClasses:y}=E(f);return G(()=>l(f.tag,{class:["v-table",{"v-table--fixed-height":!!f.height,"v-table--fixed-header":f.fixedHeader,"v-table--fixed-footer":f.fixedFooter,"v-table--has-top":!!i.top,"v-table--has-bottom":!!i.bottom,"v-table--hover":f.hover},v.value,y.value,f.class],style:f.style},{default:()=>{var V,x,T;return[(V=i.top)==null?void 0:V.call(i),i.default?l("div",{class:"v-table__wrapper",style:{height:J(f.height)}},[l("table",null,[i.default()])]):(x=i.wrapper)==null?void 0:x.call(i),(T=i.bottom)==null?void 0:T.call(i)]}})),{}}}),ce={class:"text-h3 white--text"},me={class:"text-grey-darken-1"},fe={class:"d-flex align-center mb-4"},ve=["href"],be={key:1,class:"text-grey"},pe={class:"d-flex align-center mb-4"},he=["onClick"],ge={key:1,class:"text-grey"},_e={class:"d-flex align-center justify-space-between mb-4"},ye={class:"d-flex align-center"},xe={class:"font-weight-bold mb-1"},ke={class:"text-caption mt-1"},we={key:1,class:"text-grey"},Ve={__name:"ContractorProfile",setup(f){const D=le(),i=se(),c=P(null),v=P({show:!1,text:"",color:"success"}),y=P("highToLow"),V=[{title:"Сначала с высокой оценкой",value:"highToLow"},{title:"Сначала с низкой оценкой",value:"lowToHigh"},{title:"По дате (сначала новые)",value:"newToOld"},{title:"По дате (сначала старые)",value:"oldToNew"}],x=Q(()=>{var a;if(!((a=c.value)!=null&&a.feedbacks))return[];const m=[...c.value.feedbacks];switch(y.value){case"highToLow":return m.sort((e,r)=>r.estimation-e.estimation);case"lowToHigh":return m.sort((e,r)=>e.estimation-r.estimation);case"newToOld":return m.sort((e,r)=>new Date(r.timestamp)-new Date(e.timestamp));case"oldToNew":return m.sort((e,r)=>new Date(e.timestamp)-new Date(r.timestamp));default:return m}}),T=async()=>{try{const m=await Y.get(`/api/contractors/${D.params.id}/full-profile`);c.value=m.data}catch{v.value={show:!0,text:"Ошибка загрузки профиля",color:"error"}}},O=m=>{i.push(`/projects/${m}`)},R=m=>{i.push(`/contractor/orders/${m}`)};return W(T),(m,a)=>(u(),b(X,{class:"py-10"},{default:t(()=>[l(w,{justify:"center"},{default:t(()=>[l(g,{cols:"12",md:"10",lg:"8"},{default:t(()=>[l(k,{class:"profile-card mb-8",elevation:"8"},{default:t(()=>[l(w,{"no-gutters":"",align:"center"},{default:t(()=>[l(g,{cols:"auto",class:"d-flex flex-column align-center px-8 py-8 profile-avatar-col"},{default:t(()=>[l(Z,{size:"110",color:"primary",class:"mb-4 elevation-6"},{default:t(()=>{var e,r,o;return[s("span",ce,n(((o=(r=(e=c.value)==null?void 0:e.user)==null?void 0:r.name)==null?void 0:o.charAt(0))||"?"),1)]}),_:1}),l($,{color:"primary",class:"mt-2","prepend-icon":"mdi-account-badge"},{default:t(()=>a[4]||(a[4]=[d("Исполнитель")])),_:1})]),_:1}),l(g,null,{default:t(()=>[l(F,{class:"text-h4 font-weight-bold mb-2"},{default:t(()=>{var e,r,o,h,S,N;return[d(n((r=(e=c.value)==null?void 0:e.user)==null?void 0:r.surname)+" "+n((h=(o=c.value)==null?void 0:o.user)==null?void 0:h.name)+" "+n((N=(S=c.value)==null?void 0:S.user)==null?void 0:N.patronymic),1)]}),_:1}),l(z,{class:"mb-2"},{default:t(()=>{var e,r;return[l(_,{size:"20",color:"grey-darken-1",class:"mr-1"},{default:t(()=>a[5]||(a[5]=[d("mdi-email")])),_:1}),s("span",me,n((r=(e=c.value)==null?void 0:e.user)==null?void 0:r.email),1)]}),_:1}),l(H,{class:"text-body-1 mt-2"},{default:t(()=>{var e;return[d(n(((e=c.value)==null?void 0:e.description)||"Нет описания"),1)]}),_:1})]),_:1})]),_:1})]),_:1}),l(k,{class:"mb-8 pa-6",elevation:"4"},{default:t(()=>{var e,r;return[s("div",fe,[l(_,{color:"indigo",class:"mr-2"},{default:t(()=>a[6]||(a[6]=[d("mdi-github")])),_:1}),a[7]||(a[7]=s("h3",{class:"text-h5 font-weight-bold mb-0"},"Проекты",-1))]),(r=(e=c.value)==null?void 0:e.projects)!=null&&r.length?(u(),b(w,{key:0,class:"project-list"},{default:t(()=>[(u(!0),p(B,null,C(c.value.projects,o=>(u(),b(g,{key:o.id,cols:"12",md:"6"},{default:t(()=>[l(k,{class:"mb-4 project-card",elevation:"2",onClick:h=>O(o.id),style:{cursor:"pointer"}},{default:t(()=>[l(F,{class:"font-weight-bold text-primary"},{default:t(()=>[d(n(o.name),1)]),_:2},1024),l(z,null,{default:t(()=>[l(_,{size:"18",color:"grey-darken-1",class:"mr-1"},{default:t(()=>a[8]||(a[8]=[d("mdi-link-variant")])),_:1}),s("a",{href:o.repository,target:"_blank",onClick:a[0]||(a[0]=oe(()=>{},["stop"]))},n(o.repository),9,ve)]),_:2},1024),l(H,null,{default:t(()=>[d(n(o.text),1)]),_:2},1024),o.photos&&o.photos.length?(u(),b(w,{key:0,class:"mt-2"},{default:t(()=>[(u(!0),p(B,null,C(o.photos,h=>(u(),b(g,{key:h.id,cols:"6"},{default:t(()=>[l(re,{src:h.link,"aspect-ratio":"1",class:"rounded-lg",cover:""},null,8,["src"])]),_:2},1024))),128))]),_:2},1024)):ne("",!0)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})):(u(),p("div",be,"Нет проектов"))]}),_:1}),l(k,{class:"mb-8 pa-6",elevation:"4"},{default:t(()=>{var e,r;return[s("div",pe,[l(_,{color:"teal-darken-2",class:"mr-2"},{default:t(()=>a[9]||(a[9]=[d("mdi-briefcase-outline")])),_:1}),a[10]||(a[10]=s("h3",{class:"text-h5 font-weight-bold mb-0"},"Заказы",-1))]),(r=(e=c.value)==null?void 0:e.orders)!=null&&r.length?(u(),b(de,{key:0,class:"orders-table"},{default:t(()=>[a[11]||(a[11]=s("thead",null,[s("tr",null,[s("th",null,"Название"),s("th",null,"Статус"),s("th",null,"Цена"),s("th",null,"Срок"),s("th",null,"Статус участия")])],-1)),s("tbody",null,[(u(!0),p(B,null,C(c.value.orders,o=>(u(),p("tr",{key:o.id,onClick:h=>R(o.id),style:{cursor:"pointer"}},[s("td",null,n(o.title),1),s("td",null,[l($,{color:o.status==="Завершен"?"success":o.status==="В работе"?"primary":"grey",size:"small"},{default:t(()=>[d(n(o.status),1)]),_:2},1032,["color"])]),s("td",null,n(o.price),1),s("td",null,n(o.time),1),s("td",null,n(o.order_contractor_status),1)],8,he))),128))])]),_:1})):(u(),p("div",ge,"Нет заказов"))]}),_:1}),l(k,{class:"pa-6",elevation:"4"},{default:t(()=>[s("div",_e,[s("div",ye,[l(_,{color:"amber-darken-2",class:"mr-2"},{default:t(()=>a[12]||(a[12]=[d("mdi-star-outline")])),_:1}),a[13]||(a[13]=s("h3",{class:"text-h5 font-weight-bold mb-0"},"Отзывы",-1))]),l(ee,{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=e=>y.value=e),items:V,label:"Сортировка",density:"compact",variant:"outlined",class:"feedback-sort","hide-details":""},null,8,["modelValue"])]),x.value.length?(u(),b(w,{key:0},{default:t(()=>[(u(!0),p(B,null,C(x.value,e=>(u(),b(g,{key:e.id,cols:"12"},{default:t(()=>[l(ie,{type:e.estimation>=4?"success":e.estimation>=3?"warning":"error",class:"mb-2"},{default:t(()=>[s("div",xe,[l(_,{left:"",size:"18",color:"amber"},{default:t(()=>a[14]||(a[14]=[d("mdi-star")])),_:1}),d(" Оценка: "+n(e.estimation),1)]),s("div",null,n(e.text),1),s("div",ke,n(e.timestamp),1)]),_:2},1032,["type"])]),_:2},1024))),128))]),_:1})):(u(),p("div",we,"Нет отзывов"))]),_:1})]),_:1})]),_:1}),l(ae,{modelValue:v.value.show,"onUpdate:modelValue":a[3]||(a[3]=e=>v.value.show=e),color:v.value.color,timeout:3e3},{actions:t(()=>[l(te,{variant:"text",onClick:a[2]||(a[2]=e=>v.value.show=!1)},{default:t(()=>a[15]||(a[15]=[d("Закрыть")])),_:1})]),default:t(()=>[d(n(v.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}},Ce=K(Ve,[["__scopeId","data-v-97b11ecc"]]);export{Ce as default};
