import{r as u,b as _,e as E,f as t,m as T,d as m,o as $,g as l,n as p,p as d,C as q,D as z,i as B,V,E as y,A as c,a6 as U,h as g,q as A,z as F,a5 as M}from"./index-CLuajfPy.js";import{V as N}from"./VDataTable-EGMo2_mu.js";import"./VTable-DLsL0rMv.js";const G={__name:"Directions",setup(S){const v=u([]),r=u(!1),n=u(!1),C=[{title:"ID",key:"id"},{title:"Название",key:"title"},{title:"Действия",key:"actions",sortable:!1}],o=u({title:""}),s=u({id:null,title:""}),f=async()=>{r.value=!0;try{const a=await m.get("/api/directions");v.value=a.data}catch(a){console.error("Error fetching directions:",a)}finally{r.value=!1}},D=async()=>{var a;if(o.value.title){r.value=!0;try{await m.post("/api/directions/",o.value),o.value.title="",await f()}catch(e){console.error("Error creating direction:",e),((a=e.response)==null?void 0:a.status)===409?alert("Направление с таким названием уже существует"):alert("Ошибка при создании направления")}finally{r.value=!1}}},w=a=>{s.value={...a},n.value=!0},b=async()=>{var a;if(s.value.title){r.value=!0;try{await m.put(`/api/directions/${s.value.id}`,{title:s.value.title}),n.value=!1,await f()}catch(e){console.error("Error updating direction:",e),((a=e.response)==null?void 0:a.status)===409?alert("Направление с таким названием уже существует"):alert("Ошибка при обновлении направления")}finally{r.value=!1}}},k=async a=>{if(confirm("Вы уверены, что хотите удалить это направление?")){r.value=!0;try{await m.delete(`/api/directions/${a.id}`),await f()}catch(e){console.error("Error deleting direction:",e)}finally{r.value=!1}}};return _(f),(a,e)=>($(),E(T,null,{default:t(()=>[l(g,{class:"pa-6"},{default:t(()=>[l(p,{class:"text-h5 mb-4"},{default:t(()=>e[4]||(e[4]=[d(" Управление направлениями ")])),_:1}),l(q,{onSubmit:z(D,["prevent"]),class:"mb-6"},{default:t(()=>[l(B,null,{default:t(()=>[l(V,{cols:"12",md:"8"},{default:t(()=>[l(y,{modelValue:o.value.title,"onUpdate:modelValue":e[0]||(e[0]=i=>o.value.title=i),label:"Название направления",required:"",rules:[i=>!!i||"Название обязательно"]},null,8,["modelValue","rules"])]),_:1}),l(V,{cols:"12",md:"4",class:"d-flex align-center"},{default:t(()=>[l(c,{color:"primary",type:"submit",loading:r.value,disabled:!o.value.title},{default:t(()=>e[5]||(e[5]=[d(" Добавить направление ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),l(N,{headers:C,items:v.value,loading:r.value,class:"elevation-1"},{"item.actions":t(({item:i})=>[l(c,{icon:"mdi-pencil",size:"small",color:"primary",class:"me-2",onClick:x=>w(i)},null,8,["onClick"]),l(c,{icon:"mdi-delete",size:"small",color:"error",onClick:x=>k(i)},null,8,["onClick"])]),_:1},8,["items","loading"]),l(U,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=i=>n.value=i),"max-width":"500px"},{default:t(()=>[l(g,null,{default:t(()=>[l(p,null,{default:t(()=>e[6]||(e[6]=[d("Редактировать направление")])),_:1}),l(A,null,{default:t(()=>[l(y,{modelValue:s.value.title,"onUpdate:modelValue":e[1]||(e[1]=i=>s.value.title=i),label:"Название направления",required:""},null,8,["modelValue"])]),_:1}),l(F,null,{default:t(()=>[l(M),l(c,{color:"error",onClick:e[2]||(e[2]=i=>n.value=!1)},{default:t(()=>e[7]||(e[7]=[d("Отмена")])),_:1}),l(c,{color:"primary",onClick:b},{default:t(()=>e[8]||(e[8]=[d("Сохранить")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}};export{G as default};
