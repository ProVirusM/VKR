import{G as T,H as D,I as $,J as B,K as k,g as a,L as S,M,N as E,O as L,P as w,Q as _,R as j,S as H,T as J,U as C,F as K,W as Q,X as W,r as n,o as U,e as G,f as t,n as X,p as d,C as Y,D as Z,E as b,a as P,Y as N,Z as z,t as A,l as h,A as q,h as ee,m as ae,u as le,d as F}from"./index-akZeeCib.js";const oe=T({...D({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),O=$()({name:"VRadio",props:oe(),setup(o,i){let{slots:m}=i;return B(()=>{const r=k.filterProps(o);return a(k,S(r,{class:["v-radio",o.class],style:o.style,type:"radio"}),m)}),{}}}),te=T({height:{type:[Number,String],default:"auto"},...M(),...E(L(),["multiple"]),trueIcon:{type:w,default:"$radioOn"},falseIcon:{type:w,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),se=$()({name:"VRadioGroup",inheritAttrs:!1,props:te(),emits:{"update:modelValue":o=>!0},setup(o,i){let{attrs:m,slots:r}=i;const V=_(),p=j(()=>o.id||`radio-group-${V}`),s=H(o,"modelValue");return B(()=>{const[c,g]=J(m),R=C.filterProps(o),x=k.filterProps(o),v=r.label?r.label({label:o.label,props:{for:p.value}}):o.label;return a(C,S({class:["v-radio-group",o.class],style:o.style},c,R,{modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,id:p.value}),{...r,default:e=>{let{id:l,messagesId:y,isDisabled:u,isReadonly:f}=e;return a(K,null,[v&&a(Q,{id:l.value},{default:()=>[v]}),a(W,S(x,{id:l.value,"aria-describedby":y.value,defaultsTarget:"VRadio",trueIcon:o.trueIcon,falseIcon:o.falseIcon,type:o.type,disabled:u.value,readonly:f.value,"aria-labelledby":v?l.value:void 0,multiple:!1},g,{modelValue:s.value,"onUpdate:modelValue":I=>s.value=I}),r)])}})}),{}}}),re={class:"d-flex align-center"},ue={class:"d-flex align-center"},de={__name:"RegisterView",setup(o){const i=n(""),m=n(""),r=n(""),V=n(""),p=n(""),s=n(""),c=n(!1),g=n("customer"),R=le(),x=async()=>{var v,e,l,y;s.value="",c.value=!0;try{console.log("Начало регистрации");const u=await F.post("/api/register",{usr_name:i.value,usr_surname:m.value,usr_patronymic:r.value,email:V.value,password:p.value,role:g.value});console.log("Регистрация успешна:",u.data),console.log("Попытка входа");const f=await F.post("/api/login_check",{email:V.value,password:p.value});console.log("Вход успешен:",f.data);const I=f.data.token;console.log("Токен получен:",I),localStorage.setItem("token",I),localStorage.setItem("name",f.data.name),localStorage.setItem("email",f.data.email),console.log("Перенаправление на /dashboard"),await R.push("/dashboard")}catch(u){console.error("Ошибка:",u),(e=(v=u.response)==null?void 0:v.data)!=null&&e.message?s.value=u.response.data.message:(y=(l=u.response)==null?void 0:l.data)!=null&&y.error?s.value=u.response.data.error:s.value="Произошла ошибка при регистрации"}finally{c.value=!1}};return(v,e)=>(U(),G(ae,{class:"d-flex align-center justify-center fill-height"},{default:t(()=>[a(ee,{class:"pa-6","max-width":"400",elevation:"12"},{default:t(()=>[a(X,{class:"text-h5 text-center mb-4"},{default:t(()=>e[6]||(e[6]=[d("Регистрация")])),_:1}),a(Y,{onSubmit:Z(x,["prevent"])},{default:t(()=>[a(b,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=l=>i.value=l),label:"Имя",required:""},null,8,["modelValue"]),a(b,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),label:"Фамилия",required:""},null,8,["modelValue"]),a(b,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value=l),label:"Отчество",required:""},null,8,["modelValue"]),a(b,{modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=l=>V.value=l),label:"Email",type:"email",required:""},null,8,["modelValue"]),a(b,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=l=>p.value=l),label:"Пароль",type:"password",required:""},null,8,["modelValue"]),a(se,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=l=>g.value=l),class:"mt-4"},{label:t(()=>e[7]||(e[7]=[P("div",{class:"text-subtitle-1 font-weight-bold"},"Выберите роль:",-1)])),default:t(()=>[a(O,{value:"customer",color:"primary"},{label:t(()=>[P("div",re,[a(N,{color:"primary",class:"mr-2"},{default:t(()=>e[8]||(e[8]=[d("mdi-account")])),_:1}),e[9]||(e[9]=d(" Заказчик "))])]),_:1}),a(O,{value:"contractor",color:"primary"},{label:t(()=>[P("div",ue,[a(N,{color:"primary",class:"mr-2"},{default:t(()=>e[10]||(e[10]=[d("mdi-briefcase")])),_:1}),e[11]||(e[11]=d(" Исполнитель "))])]),_:1})]),_:1},8,["modelValue"]),s.value?(U(),G(z,{key:0,type:"error",class:"mt-3"},{default:t(()=>[d(A(s.value),1)]),_:1})):h("",!0),a(q,{type:"submit",color:"success",class:"mt-4",block:"",loading:c.value,disabled:c.value},{default:t(()=>[d(A(c.value?"Регистрация...":"Зарегистрироваться"),1)]),_:1},8,["loading","disabled"]),a(q,{variant:"text",class:"mt-2",block:"",to:"/login"},{default:t(()=>e[12]||(e[12]=[d("Уже есть аккаунт?")])),_:1})]),_:1})]),_:1})]),_:1}))}};export{de as default};
