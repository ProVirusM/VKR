import{r,b as S,e as z,f as i,m as B,d as s,o as j,g as a,n as _,p as d,C as A,D as F,i as L,V,j as p,E as b,A as g,t as k,a4 as M,h as w,q as I,z as R,a3 as G}from"./index-BS_DGpDW.js";import{V as H}from"./VDataTable-4UGNYHhj.js";import"./VTable-CqhgBNWO.js";const Q={__name:"Technologies",setup(J){const y=r([]),m=r([]),v=r([]),u=r(!1),c=r(!1),C=[{title:"ID",key:"id"},{title:"Название",key:"title"},{title:"Направление",key:"direction"},{title:"Язык программирования",key:"language"},{title:"Действия",key:"actions",sortable:!1}],o=r({title:"",direction_id:null,language_id:null}),n=r({id:null,title:"",direction_id:null,language_id:null}),f=async()=>{u.value=!0;try{const t=await s.get("/api/stacks/all");y.value=t.data}catch(t){console.error("Error fetching technologies:",t)}finally{u.value=!1}},T=async()=>{try{const t=await s.get("/api/directions");m.value=t.data}catch(t){console.error("Error fetching directions:",t)}},x=async()=>{try{const t=await s.get("/api/languages");v.value=t.data}catch(t){console.error("Error fetching languages:",t)}},D=t=>{const e=m.value.find(l=>l.id===t);return e?e.title:""},h=t=>{const e=v.value.find(l=>l.id===t);return e?e.title:""},q=async()=>{if(!(!o.value.title||!o.value.direction_id||!o.value.language_id)){u.value=!0;try{await s.post("/api/stacks/",o.value),o.value={title:"",direction_id:null,language_id:null},await f()}catch(t){console.error("Error creating technology:",t)}finally{u.value=!1}}},E=t=>{n.value={...t},c.value=!0},U=async()=>{if(!(!n.value.title||!n.value.direction_id||!n.value.language_id)){u.value=!0;try{await s.put(`/api/stacks/${n.value.id}`,{title:n.value.title,direction_id:n.value.direction_id,language_id:n.value.language_id}),c.value=!1,await f()}catch(t){console.error("Error updating technology:",t)}finally{u.value=!1}}},$=async t=>{if(confirm("Вы уверены, что хотите удалить эту технологию?")){u.value=!0;try{await s.delete(`/api/stacks/${t.id}`),await f()}catch(e){console.error("Error deleting technology:",e)}finally{u.value=!1}}};return S(()=>{f(),T(),x()}),(t,e)=>(j(),z(B,null,{default:i(()=>[a(w,{class:"pa-6"},{default:i(()=>[a(_,{class:"text-h5 mb-4"},{default:i(()=>e[8]||(e[8]=[d(" Управление технологиями ")])),_:1}),a(A,{onSubmit:F(q,["prevent"]),class:"mb-6"},{default:i(()=>[a(L,null,{default:i(()=>[a(V,{cols:"12",md:"4"},{default:i(()=>[a(p,{modelValue:o.value.direction_id,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.direction_id=l),items:m.value,"item-title":"title","item-value":"id",label:"Направление",required:""},null,8,["modelValue","items"])]),_:1}),a(V,{cols:"12",md:"4"},{default:i(()=>[a(p,{modelValue:o.value.language_id,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.language_id=l),items:v.value,"item-title":"title","item-value":"id",label:"Язык программирования",required:""},null,8,["modelValue","items"])]),_:1}),a(V,{cols:"12",md:"4"},{default:i(()=>[a(b,{modelValue:o.value.title,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.title=l),label:"Название технологии",required:"",rules:[l=>!!l||"Название обязательно"]},null,8,["modelValue","rules"])]),_:1}),a(V,{cols:"12",class:"d-flex justify-end"},{default:i(()=>[a(g,{color:"primary",type:"submit",loading:u.value,disabled:!o.value.title||!o.value.direction_id||!o.value.language_id},{default:i(()=>e[9]||(e[9]=[d(" Добавить технологию ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),a(H,{headers:C,items:y.value,loading:u.value,class:"elevation-1"},{"item.direction":i(({item:l})=>[d(k(D(l.direction_id)),1)]),"item.language":i(({item:l})=>[d(k(h(l.language_id)),1)]),"item.actions":i(({item:l})=>[a(g,{icon:"mdi-pencil",size:"small",color:"primary",class:"me-2",onClick:N=>E(l)},null,8,["onClick"]),a(g,{icon:"mdi-delete",size:"small",color:"error",onClick:N=>$(l)},null,8,["onClick"])]),_:1},8,["items","loading"]),a(M,{modelValue:c.value,"onUpdate:modelValue":e[7]||(e[7]=l=>c.value=l),"max-width":"500px"},{default:i(()=>[a(w,null,{default:i(()=>[a(_,null,{default:i(()=>e[10]||(e[10]=[d("Редактировать технологию")])),_:1}),a(I,null,{default:i(()=>[a(p,{modelValue:n.value.direction_id,"onUpdate:modelValue":e[3]||(e[3]=l=>n.value.direction_id=l),items:m.value,"item-title":"title","item-value":"id",label:"Направление",required:"",class:"mb-4"},null,8,["modelValue","items"]),a(p,{modelValue:n.value.language_id,"onUpdate:modelValue":e[4]||(e[4]=l=>n.value.language_id=l),items:v.value,"item-title":"title","item-value":"id",label:"Язык программирования",required:"",class:"mb-4"},null,8,["modelValue","items"]),a(b,{modelValue:n.value.title,"onUpdate:modelValue":e[5]||(e[5]=l=>n.value.title=l),label:"Название технологии",required:""},null,8,["modelValue"])]),_:1}),a(R,null,{default:i(()=>[a(G),a(g,{color:"error",onClick:e[6]||(e[6]=l=>c.value=!1)},{default:i(()=>e[11]||(e[11]=[d("Отмена")])),_:1}),a(g,{color:"primary",onClick:U},{default:i(()=>e[12]||(e[12]=[d("Сохранить")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}};export{Q as default};
