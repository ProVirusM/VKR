import{_ as I,r as x,R as P,b as H,e as m,f as t,m as M,d as U,o as i,g as l,V as _,h as b,i as y,a0 as j,a,t as n,v as D,p as u,n as N,a8 as S,Y as g,q as z,c as f,k as h,F as k,j as q,A as E,a2 as Y,a3 as G,u as J,D as B,a9 as K,aa as Q,l as W,$ as X}from"./index-DoJXksh4.js";import{V as Z}from"./VTable-DMGYF-kC.js";const tt={class:"text-h3 white--text"},et={class:"text-grey-darken-1"},st={class:"d-flex align-center mb-4"},lt=["href"],at={key:1,class:"text-grey"},ot={class:"d-flex align-center mb-4"},rt=["onClick"],nt={key:1,class:"text-grey"},it={class:"d-flex align-center justify-space-between mb-4"},ut={class:"d-flex align-center"},dt={class:"font-weight-bold mb-1"},ct={class:"text-caption mt-1"},mt={key:1,class:"text-grey"},ft={__name:"ContractorProfile",setup(vt){const A=G(),V=J(),d=x(null),p=x({show:!1,text:"",color:"success"}),w=x("highToLow"),L=[{title:"Сначала с высокой оценкой",value:"highToLow"},{title:"Сначала с низкой оценкой",value:"lowToHigh"},{title:"По дате (сначала новые)",value:"newToOld"},{title:"По дате (сначала старые)",value:"oldToNew"}],C=P(()=>{var e;if(!((e=d.value)!=null&&e.feedbacks))return[];const c=[...d.value.feedbacks];switch(w.value){case"highToLow":return c.sort((s,r)=>r.estimation-s.estimation);case"lowToHigh":return c.sort((s,r)=>s.estimation-r.estimation);case"newToOld":return c.sort((s,r)=>new Date(r.timestamp)-new Date(s.timestamp));case"oldToNew":return c.sort((s,r)=>new Date(s.timestamp)-new Date(r.timestamp));default:return c}}),O=async()=>{try{const c=await U.get(`/api/contractors/${A.params.id}/full-profile`);d.value=c.data}catch{p.value={show:!0,text:"Ошибка загрузки профиля",color:"error"}}},R=c=>{V.push(`/projects/${c}`)},F=c=>{V.push(`/contractor/orders/${c}`)};return H(O),(c,e)=>(i(),m(M,{class:"py-10"},{default:t(()=>[l(y,{justify:"center"},{default:t(()=>[l(_,{cols:"12",md:"10",lg:"8"},{default:t(()=>[l(b,{class:"profile-card mb-8",elevation:"8"},{default:t(()=>[l(y,{"no-gutters":"",align:"center"},{default:t(()=>[l(_,{cols:"auto",class:"d-flex flex-column align-center px-8 py-8 profile-avatar-col"},{default:t(()=>[l(j,{size:"110",color:"primary",class:"mb-4 elevation-6"},{default:t(()=>{var s,r,o;return[a("span",tt,n(((o=(r=(s=d.value)==null?void 0:s.user)==null?void 0:r.name)==null?void 0:o.charAt(0))||"?"),1)]}),_:1}),l(D,{color:"primary",class:"mt-2","prepend-icon":"mdi-account-badge"},{default:t(()=>e[5]||(e[5]=[u("Исполнитель")])),_:1})]),_:1}),l(_,null,{default:t(()=>[l(N,{class:"text-h4 font-weight-bold mb-2"},{default:t(()=>{var s,r,o,v,T,$;return[u(n((r=(s=d.value)==null?void 0:s.user)==null?void 0:r.surname)+" "+n((v=(o=d.value)==null?void 0:o.user)==null?void 0:v.name)+" "+n(($=(T=d.value)==null?void 0:T.user)==null?void 0:$.patronymic),1)]}),_:1}),l(S,{class:"mb-2"},{default:t(()=>{var s,r;return[l(g,{size:"20",color:"grey-darken-1",class:"mr-1"},{default:t(()=>e[6]||(e[6]=[u("mdi-email")])),_:1}),a("span",et,n((r=(s=d.value)==null?void 0:s.user)==null?void 0:r.email),1)]}),_:1}),l(z,{class:"text-body-1 mt-2"},{default:t(()=>{var s;return[u(n(((s=d.value)==null?void 0:s.description)||"Нет описания"),1)]}),_:1})]),_:1})]),_:1})]),_:1}),l(b,{class:"mb-8 pa-6",elevation:"4"},{default:t(()=>{var s,r;return[a("div",st,[l(g,{color:"indigo",class:"mr-2"},{default:t(()=>e[7]||(e[7]=[u("mdi-github")])),_:1}),e[8]||(e[8]=a("h3",{class:"text-h5 font-weight-bold mb-0"},"Проекты",-1))]),(r=(s=d.value)==null?void 0:s.projects)!=null&&r.length?(i(),m(y,{key:0,class:"project-list"},{default:t(()=>[(i(!0),f(k,null,h(d.value.projects,o=>(i(),m(_,{key:o.id,cols:"12",md:"6"},{default:t(()=>[l(b,{class:"mb-4 project-card",elevation:"2",onClick:v=>R(o.id),style:{cursor:"pointer"}},{default:t(()=>[l(N,{class:"font-weight-bold text-primary"},{default:t(()=>[u(n(o.name),1)]),_:2},1024),l(S,null,{default:t(()=>[l(g,{size:"18",color:"grey-darken-1",class:"mr-1"},{default:t(()=>e[9]||(e[9]=[u("mdi-link-variant")])),_:1}),a("a",{href:o.repository,target:"_blank",onClick:e[0]||(e[0]=B(()=>{},["stop"]))},n(o.repository),9,lt)]),_:2},1024),l(z,null,{default:t(()=>[u(n(o.text),1)]),_:2},1024),o.photos&&o.photos.length?(i(),m(y,{key:0,class:"mt-2"},{default:t(()=>[l(_,{cols:"12"},{default:t(()=>[l(K,{"hide-delimiter-background":"","show-arrows":"hover",height:"200",onClick:e[1]||(e[1]=B(()=>{},["stop"]))},{default:t(()=>[(i(!0),f(k,null,h(o.photos,v=>(i(),m(Q,{key:v.id,src:v.link,cover:""},null,8,["src"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)):W("",!0)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})):(i(),f("div",at,"Нет проектов"))]}),_:1}),l(b,{class:"mb-8 pa-6",elevation:"4"},{default:t(()=>{var s,r;return[a("div",ot,[l(g,{color:"teal-darken-2",class:"mr-2"},{default:t(()=>e[10]||(e[10]=[u("mdi-briefcase-outline")])),_:1}),e[11]||(e[11]=a("h3",{class:"text-h5 font-weight-bold mb-0"},"Заказы",-1))]),(r=(s=d.value)==null?void 0:s.orders)!=null&&r.length?(i(),m(Z,{key:0,class:"orders-table"},{default:t(()=>[e[12]||(e[12]=a("thead",null,[a("tr",null,[a("th",null,"Название"),a("th",null,"Статус"),a("th",null,"Цена"),a("th",null,"Срок"),a("th",null,"Статус участия")])],-1)),a("tbody",null,[(i(!0),f(k,null,h(d.value.orders,o=>(i(),f("tr",{key:o.id,onClick:v=>F(o.id),style:{cursor:"pointer"}},[a("td",null,n(o.title),1),a("td",null,[l(D,{color:o.status==="Завершен"?"success":o.status==="В работе"?"primary":"grey",size:"small"},{default:t(()=>[u(n(o.status),1)]),_:2},1032,["color"])]),a("td",null,n(o.price),1),a("td",null,n(o.time),1),a("td",null,n(o.order_contractor_status),1)],8,rt))),128))])]),_:1})):(i(),f("div",nt,"Нет заказов"))]}),_:1}),l(b,{class:"pa-6",elevation:"4"},{default:t(()=>[a("div",it,[a("div",ut,[l(g,{color:"amber-darken-2",class:"mr-2"},{default:t(()=>e[13]||(e[13]=[u("mdi-star-outline")])),_:1}),e[14]||(e[14]=a("h3",{class:"text-h5 font-weight-bold mb-0"},"Отзывы",-1))]),l(q,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=s=>w.value=s),items:L,label:"Сортировка",density:"compact",variant:"outlined",class:"feedback-sort","hide-details":""},null,8,["modelValue"])]),C.value.length?(i(),m(y,{key:0},{default:t(()=>[(i(!0),f(k,null,h(C.value,s=>(i(),m(_,{key:s.id,cols:"12"},{default:t(()=>[l(X,{type:s.estimation>=4?"success":s.estimation>=3?"warning":"error",class:"mb-2"},{default:t(()=>[a("div",dt,[l(g,{left:"",size:"18",color:"amber"},{default:t(()=>e[15]||(e[15]=[u("mdi-star")])),_:1}),u(" Оценка: "+n(s.estimation),1)]),a("div",null,n(s.text),1),a("div",ct,n(s.timestamp),1)]),_:2},1032,["type"])]),_:2},1024))),128))]),_:1})):(i(),f("div",mt,"Нет отзывов"))]),_:1})]),_:1})]),_:1}),l(Y,{modelValue:p.value.show,"onUpdate:modelValue":e[4]||(e[4]=s=>p.value.show=s),color:p.value.color,timeout:3e3},{actions:t(()=>[l(E,{variant:"text",onClick:e[3]||(e[3]=s=>p.value.show=!1)},{default:t(()=>e[16]||(e[16]=[u("Закрыть")])),_:1})]),default:t(()=>[u(n(p.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}},gt=I(ft,[["__scopeId","data-v-6c72ef35"]]);export{gt as default};
