import{_ as U,r as c,b as z,d as y,w as b,e as V,o as d,f as s,g as l,V as m,h as B,i as w,j as C,c as S,k as D,F as L,l as $,m as F,u as R,n as E,p as _,t as v,q as A,a as p,s as G,v as I,x as H,y as J,z as K,A as Q}from"./index-DVk_bx9_.js";const W={class:"text-subtitle-2 text-error"},X={class:"text-caption text-right text-grey mt-2"},Y={key:0,class:"text-center"},Z={__name:"Orders",setup(ee){const M=R(),j=c([]),h=c([]),f=c([]),u=c([]),i=c([]),o=c([]),k=c([]);z(()=>{N(),x()});const N=async()=>{try{const e=await y.get("/api/directions");j.value=e.data}catch(e){console.error("Ошибка при загрузке направлений:",e)}};b(u,async e=>{if(!e.length){h.value=[],f.value=[],i.value=[],o.value=[];return}await O(),i.value=[],o.value=[],f.value=[],x()});const O=async()=>{try{const e=u.value.map(n=>y.get(`/api/languages/${n}`)),t=(await Promise.all(e)).flatMap(n=>n.data),r=Array.from(new Set(t.map(n=>n.id))).map(n=>t.find(g=>g.id===n));h.value=r}catch(e){console.error("Ошибка при загрузке языков:",e)}};b(i,async e=>{if(!e.length){f.value=[],o.value=[];return}await P(),o.value=[],x()});const P=async()=>{if(!(!i.value.length||!u.value.length))try{const e=i.value.flatMap(n=>u.value.map(g=>y.get(`/api/stacks/${n}/${g}`))),t=(await Promise.all(e)).flatMap(n=>n.data),r=Array.from(new Set(t.map(n=>n.id))).map(n=>t.find(g=>g.id===n));f.value=r}catch(e){console.error("Ошибка при загрузке технологий:",e)}};b(o,()=>{x()});const x=async()=>{const e={};u.value.length&&(e.direction=u.value.join(",")),i.value.length&&(e.language=i.value.join(",")),o.value.length&&(e.stacks=o.value.join(","));try{const a=await y.get("/api/orders",{params:e});k.value=a.data}catch(a){console.error("Ошибка при фильтрации заказов:",a)}},q=e=>{M.push(`/order/${e}`)},T=e=>{switch(e){case"В процессе":return"text-orange";case"Завершен":return"text-green";case"Отменен":return"text-red";default:return"text-grey"}};return(e,a)=>(d(),V(F,{fluid:"",class:"py-10"},{default:s(()=>[l(w,{justify:"center"},{default:s(()=>[l(m,{cols:"12",md:"8"},{default:s(()=>[l(B,{class:"mb-6 pa-4",elevation:"2"},{default:s(()=>[l(w,null,{default:s(()=>[l(m,{cols:"12",sm:"4"},{default:s(()=>[l(C,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=t=>u.value=t),items:j.value,"item-text":"title","item-value":"id",label:"Выберите направления",outlined:"",dense:"",multiple:"",chips:"","closable-chips":""},null,8,["modelValue","items"])]),_:1}),l(m,{cols:"12",sm:"4"},{default:s(()=>[l(C,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=t=>i.value=t),items:h.value,"item-text":"title","item-value":"id",label:"Выберите языки",disabled:!u.value.length,outlined:"",dense:"",multiple:"",chips:"","closable-chips":""},null,8,["modelValue","items","disabled"])]),_:1}),l(m,{cols:"12",sm:"4"},{default:s(()=>[l(C,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=t=>o.value=t),items:f.value,"item-text":"title","item-value":"id",label:"Выберите технологии",disabled:!i.value.length,outlined:"",dense:"",multiple:"",chips:"","closable-chips":""},null,8,["modelValue","items","disabled"])]),_:1})]),_:1})]),_:1}),(d(!0),S(L,null,D(k.value,t=>(d(),V(B,{key:t.id,class:"mb-4 pa-6",elevation:"10",rounded:"xl"},{default:s(()=>[l(E,{class:"text-h5 text-primary"},{default:s(()=>[_(v(t.title),1)]),_:2},1024),l(A,{class:"text-body-1 text-grey-darken-2"},{default:s(()=>[_(v(t.text),1)]),_:2},1024),t.stacks&&t.stacks.length?(d(),V(A,{key:0},{default:s(()=>[a[3]||(a[3]=p("div",{class:"text-subtitle-2 mb-2"},"Технологии:",-1)),l(G,null,{default:s(()=>[(d(!0),S(L,null,D(t.stacks,r=>(d(),V(I,{key:r.id,color:"primary",variant:"outlined",class:"ma-1"},{default:s(()=>[_(v(r.title),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)):$("",!0),l(H,{class:"my-4"}),l(w,{justify:"space-between"},{default:s(()=>[l(m,{cols:"6"},{default:s(()=>[a[4]||(a[4]=p("div",{class:"text-caption text-grey"},"Статус:",-1)),p("div",{class:J([T(t.status),"text-subtitle-2"])},v(t.status),3)]),_:2},1024),l(m,{cols:"6",class:"text-right"},{default:s(()=>[a[5]||(a[5]=p("div",{class:"text-caption text-grey"},"Цена:",-1)),p("div",W,v(t.price)+" ₽ ",1)]),_:2},1024)]),_:2},1024),p("div",X," Срок: "+v(t.time),1),l(K,{class:"justify-end"},{default:s(()=>[l(Q,{color:"primary",variant:"elevated",rounded:"",onClick:r=>q(t.id)},{default:s(()=>a[6]||(a[6]=[_(" Подробнее ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),k.value.length?$("",!0):(d(),S("p",Y,"Заказы не найдены."))]),_:1})]),_:1})]),_:1}))}},ae=U(Z,[["__scopeId","data-v-f55904be"]]);export{ae as default};
