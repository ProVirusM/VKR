import{_ as S,r as x,b as T,e as k,f as t,m as R,a1 as j,d as h,o as u,g as a,V as d,a as f,x as w,i as v,c as $,F as D,k as F,h as I,Y as M,p as r,A as y,t as i,a5 as O,u as P,a6 as U,$ as q,n as E,q as L,v as Y,z as G}from"./index-akZeeCib.js";const H={key:0,class:"contractors-list"},J={class:"text-h4 white--text"},K={__name:"OrderContractors",setup(Q){const g=x([]),V=P(),_=j().params.id,c=x(!1),l=x({show:!1,text:"",color:"success"}),p=(o,e="success")=>{l.value={show:!0,text:o,color:e}},z=async o=>{var s,m,C,b;c.value=!0;const e=localStorage.getItem("token");try{const n=await h.post(`/api/orders/${_}/approve-contractor/${o}`,{},{headers:{Authorization:`Bearer ${e}`}});n.data.message?p(n.data.message,"success"):p("Исполнитель успешно одобрен!","success"),V.push("/customer/completed-orders")}catch(n){console.error("Ошибка при одобрении исполнителя",n);const A=((m=(s=n.response)==null?void 0:s.data)==null?void 0:m.message)||((b=(C=n.response)==null?void 0:C.data)==null?void 0:b.error)||"Не удалось одобрить исполнителя";p(A,"error")}finally{c.value=!1}},B=o=>{V.push(`/contractor/${o}`)},N=async()=>{c.value=!0;const o=localStorage.getItem("token");try{const e=await h.get(`/api/orders/${_}/contractors`,{headers:{Authorization:`Bearer ${o}`}});g.value=e.data}catch(e){console.error("Ошибка при загрузке исполнителей",e),p("Не удалось загрузить список исполнителей","error")}finally{c.value=!1}};return T(()=>{N()}),(o,e)=>(u(),k(R,{class:"pa-8"},{default:t(()=>[a(v,{justify:"center",class:"mb-8"},{default:t(()=>[a(d,{cols:"12",class:"text-center"},{default:t(()=>[e[2]||(e[2]=f("h1",{class:"text-h3 font-weight-bold mb-2"}," Откликнувшиеся исполнители ",-1)),a(w,{class:"mx-auto",style:{"max-width":"200px"}})]),_:1})]),_:1}),g.value.length?(u(),$("div",H,[a(v,null,{default:t(()=>[(u(!0),$(D,null,F(g.value,s=>(u(),k(d,{key:s.contractorId,cols:"12",class:"mb-6"},{default:t(()=>[a(I,{class:"contractor-card h-100",elevation:"4",rounded:"xl",loading:c.value},{default:t(()=>[a(U,null,{prepend:t(()=>[a(q,{size:"80",class:"mr-4",color:"primary",elevation:"4"},{default:t(()=>[f("span",J,i(s.userName?s.userName.charAt(0).toUpperCase():""),1)]),_:2},1024)]),default:t(()=>[a(E,{class:"text-h5 font-weight-bold"},{default:t(()=>[r(i(s.userSurname)+" "+i(s.userName)+" "+i(s.userPatronymic),1)]),_:2},1024)]),_:2},1024),a(L,null,{default:t(()=>[a(Y,{color:"primary",variant:"outlined",class:"mb-2","prepend-icon":"mdi-account-check"},{default:t(()=>e[3]||(e[3]=[r(" Исполнитель ")])),_:1})]),_:1}),a(w,{class:"mx-4"}),a(G,{class:"pa-4"},{default:t(()=>[a(v,null,{default:t(()=>[a(d,{cols:"12"},{default:t(()=>[a(y,{block:"",color:"success",size:"large",variant:"elevated",class:"mb-2","prepend-icon":"mdi-check-circle",onClick:m=>z(s.contractorId)},{default:t(()=>e[4]||(e[4]=[r(" Одобрить ")])),_:2},1032,["onClick"])]),_:2},1024),a(d,{cols:"12"},{default:t(()=>[a(y,{block:"",color:"primary",size:"large",variant:"outlined","prepend-icon":"mdi-account-circle",onClick:m=>B(s.contractorId)},{default:t(()=>e[5]||(e[5]=[r(" Профиль ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["loading"])]),_:2},1024))),128))]),_:1})])):(u(),k(v,{key:1,justify:"center",class:"mt-16"},{default:t(()=>[a(d,{cols:"12",md:"8",lg:"6",class:"text-center"},{default:t(()=>[a(I,{class:"pa-8",variant:"outlined"},{default:t(()=>[a(M,{size:"64",color:"grey",class:"mb-4"},{default:t(()=>e[6]||(e[6]=[r(" mdi-account-group-outline ")])),_:1}),e[7]||(e[7]=f("h2",{class:"text-h4 font-weight-bold mb-2 text-grey"}," Нет откликнувшихся исполнителей ",-1)),e[8]||(e[8]=f("p",{class:"text-body-1 text-grey"}," Пока никто не откликнулся на ваш заказ. Пожалуйста, подождите. ",-1))]),_:1})]),_:1})]),_:1})),a(O,{modelValue:l.value.show,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.show=s),color:l.value.color,timeout:3e3},{actions:t(()=>[a(y,{variant:"text",onClick:e[0]||(e[0]=s=>l.value.show=!1)},{default:t(()=>e[9]||(e[9]=[r(" Закрыть ")])),_:1})]),default:t(()=>[r(i(l.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}},Z=S(K,[["__scopeId","data-v-b9e44e38"]]);export{Z as default};
