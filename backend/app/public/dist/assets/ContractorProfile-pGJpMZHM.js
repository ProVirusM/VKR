import{_ as F,r as x,R as I,b as P,e as m,f as t,m as H,d as M,o as i,g as l,V as _,h as b,i as h,a0 as U,a,t as n,v as D,p as u,n as N,a8 as S,Y as g,q as z,c as f,k as y,F as k,j,A as q,a2 as E,a3 as Y,u as G,D as J,a9 as K,aa as Q,l as W,$ as X}from"./index-Bjf0RIAy.js";import{V as Z}from"./VTable-BSs-gSsr.js";const tt={class:"text-h3 white--text"},et={class:"text-grey-darken-1"},st={class:"d-flex align-center mb-4"},lt=["href"],at={key:1,class:"text-grey"},ot={class:"d-flex align-center mb-4"},rt=["onClick"],nt={key:1,class:"text-grey"},it={class:"d-flex align-center justify-space-between mb-4"},ut={class:"d-flex align-center"},dt={class:"font-weight-bold mb-1"},ct={class:"text-caption mt-1"},mt={key:1,class:"text-grey"},ft={__name:"ContractorProfile",setup(vt){const B=Y(),V=G(),d=x(null),p=x({show:!1,text:"",color:"success"}),w=x("highToLow"),A=[{title:"Сначала с высокой оценкой",value:"highToLow"},{title:"Сначала с низкой оценкой",value:"lowToHigh"},{title:"По дате (сначала новые)",value:"newToOld"},{title:"По дате (сначала старые)",value:"oldToNew"}],C=I(()=>{var s;if(!((s=d.value)!=null&&s.feedbacks))return[];const c=[...d.value.feedbacks];switch(w.value){case"highToLow":return c.sort((e,r)=>r.estimation-e.estimation);case"lowToHigh":return c.sort((e,r)=>e.estimation-r.estimation);case"newToOld":return c.sort((e,r)=>new Date(r.timestamp)-new Date(e.timestamp));case"oldToNew":return c.sort((e,r)=>new Date(e.timestamp)-new Date(r.timestamp));default:return c}}),L=async()=>{try{const c=await M.get(`/api/contractors/${B.params.id}/full-profile`);d.value=c.data}catch{p.value={show:!0,text:"Ошибка загрузки профиля",color:"error"}}},O=c=>{V.push(`/projects/${c}`)},R=c=>{V.push(`/contractor/orders/${c}`)};return P(L),(c,s)=>(i(),m(H,{class:"py-10"},{default:t(()=>[l(h,{justify:"center"},{default:t(()=>[l(_,{cols:"12",md:"10",lg:"8"},{default:t(()=>[l(b,{class:"profile-card mb-8",elevation:"8"},{default:t(()=>[l(h,{"no-gutters":"",align:"center"},{default:t(()=>[l(_,{cols:"auto",class:"d-flex flex-column align-center px-8 py-8 profile-avatar-col"},{default:t(()=>[l(U,{size:"110",color:"primary",class:"mb-4 elevation-6"},{default:t(()=>{var e,r,o;return[a("span",tt,n(((o=(r=(e=d.value)==null?void 0:e.user)==null?void 0:r.name)==null?void 0:o.charAt(0))||"?"),1)]}),_:1}),l(D,{color:"primary",class:"mt-2","prepend-icon":"mdi-account-badge"},{default:t(()=>s[4]||(s[4]=[u("Исполнитель")])),_:1})]),_:1}),l(_,null,{default:t(()=>[l(N,{class:"text-h4 font-weight-bold mb-2"},{default:t(()=>{var e,r,o,v,T,$;return[u(n((r=(e=d.value)==null?void 0:e.user)==null?void 0:r.surname)+" "+n((v=(o=d.value)==null?void 0:o.user)==null?void 0:v.name)+" "+n(($=(T=d.value)==null?void 0:T.user)==null?void 0:$.patronymic),1)]}),_:1}),l(S,{class:"mb-2"},{default:t(()=>{var e,r;return[l(g,{size:"20",color:"grey-darken-1",class:"mr-1"},{default:t(()=>s[5]||(s[5]=[u("mdi-email")])),_:1}),a("span",et,n((r=(e=d.value)==null?void 0:e.user)==null?void 0:r.email),1)]}),_:1}),l(z,{class:"text-body-1 mt-2"},{default:t(()=>{var e;return[u(n(((e=d.value)==null?void 0:e.description)||"Нет описания"),1)]}),_:1})]),_:1})]),_:1})]),_:1}),l(b,{class:"mb-8 pa-6",elevation:"4"},{default:t(()=>{var e,r;return[a("div",st,[l(g,{color:"indigo",class:"mr-2"},{default:t(()=>s[6]||(s[6]=[u("mdi-github")])),_:1}),s[7]||(s[7]=a("h3",{class:"text-h5 font-weight-bold mb-0"},"Проекты",-1))]),(r=(e=d.value)==null?void 0:e.projects)!=null&&r.length?(i(),m(h,{key:0,class:"project-list"},{default:t(()=>[(i(!0),f(k,null,y(d.value.projects,o=>(i(),m(_,{key:o.id,cols:"12",md:"6"},{default:t(()=>[l(b,{class:"mb-4 project-card",elevation:"2",onClick:v=>O(o.id),style:{cursor:"pointer"}},{default:t(()=>[l(N,{class:"font-weight-bold text-primary"},{default:t(()=>[u(n(o.name),1)]),_:2},1024),l(S,null,{default:t(()=>[l(g,{size:"18",color:"grey-darken-1",class:"mr-1"},{default:t(()=>s[8]||(s[8]=[u("mdi-link-variant")])),_:1}),a("a",{href:o.repository,target:"_blank",onClick:s[0]||(s[0]=J(()=>{},["stop"]))},n(o.repository),9,lt)]),_:2},1024),l(z,null,{default:t(()=>[u(n(o.text),1)]),_:2},1024),o.photos&&o.photos.length?(i(),m(h,{key:0,class:"mt-2"},{default:t(()=>[l(_,{cols:"12"},{default:t(()=>[l(K,{"hide-delimiter-background":"","show-arrows":"hover",height:"200"},{default:t(()=>[(i(!0),f(k,null,y(o.photos,v=>(i(),m(Q,{key:v.id,src:v.link,cover:""},null,8,["src"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)):W("",!0)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})):(i(),f("div",at,"Нет проектов"))]}),_:1}),l(b,{class:"mb-8 pa-6",elevation:"4"},{default:t(()=>{var e,r;return[a("div",ot,[l(g,{color:"teal-darken-2",class:"mr-2"},{default:t(()=>s[9]||(s[9]=[u("mdi-briefcase-outline")])),_:1}),s[10]||(s[10]=a("h3",{class:"text-h5 font-weight-bold mb-0"},"Заказы",-1))]),(r=(e=d.value)==null?void 0:e.orders)!=null&&r.length?(i(),m(Z,{key:0,class:"orders-table"},{default:t(()=>[s[11]||(s[11]=a("thead",null,[a("tr",null,[a("th",null,"Название"),a("th",null,"Статус"),a("th",null,"Цена"),a("th",null,"Срок"),a("th",null,"Статус участия")])],-1)),a("tbody",null,[(i(!0),f(k,null,y(d.value.orders,o=>(i(),f("tr",{key:o.id,onClick:v=>R(o.id),style:{cursor:"pointer"}},[a("td",null,n(o.title),1),a("td",null,[l(D,{color:o.status==="Завершен"?"success":o.status==="В работе"?"primary":"grey",size:"small"},{default:t(()=>[u(n(o.status),1)]),_:2},1032,["color"])]),a("td",null,n(o.price),1),a("td",null,n(o.time),1),a("td",null,n(o.order_contractor_status),1)],8,rt))),128))])]),_:1})):(i(),f("div",nt,"Нет заказов"))]}),_:1}),l(b,{class:"pa-6",elevation:"4"},{default:t(()=>[a("div",it,[a("div",ut,[l(g,{color:"amber-darken-2",class:"mr-2"},{default:t(()=>s[12]||(s[12]=[u("mdi-star-outline")])),_:1}),s[13]||(s[13]=a("h3",{class:"text-h5 font-weight-bold mb-0"},"Отзывы",-1))]),l(j,{modelValue:w.value,"onUpdate:modelValue":s[1]||(s[1]=e=>w.value=e),items:A,label:"Сортировка",density:"compact",variant:"outlined",class:"feedback-sort","hide-details":""},null,8,["modelValue"])]),C.value.length?(i(),m(h,{key:0},{default:t(()=>[(i(!0),f(k,null,y(C.value,e=>(i(),m(_,{key:e.id,cols:"12"},{default:t(()=>[l(X,{type:e.estimation>=4?"success":e.estimation>=3?"warning":"error",class:"mb-2"},{default:t(()=>[a("div",dt,[l(g,{left:"",size:"18",color:"amber"},{default:t(()=>s[14]||(s[14]=[u("mdi-star")])),_:1}),u(" Оценка: "+n(e.estimation),1)]),a("div",null,n(e.text),1),a("div",ct,n(e.timestamp),1)]),_:2},1032,["type"])]),_:2},1024))),128))]),_:1})):(i(),f("div",mt,"Нет отзывов"))]),_:1})]),_:1})]),_:1}),l(E,{modelValue:p.value.show,"onUpdate:modelValue":s[3]||(s[3]=e=>p.value.show=e),color:p.value.color,timeout:3e3},{actions:t(()=>[l(q,{variant:"text",onClick:s[2]||(s[2]=e=>p.value.show=!1)},{default:t(()=>s[15]||(s[15]=[u("Закрыть")])),_:1})]),default:t(()=>[u(n(p.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}},gt=F(ft,[["__scopeId","data-v-12c7b305"]]);export{gt as default};
